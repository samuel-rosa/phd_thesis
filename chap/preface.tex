\chapter*{Preface}

I was never sure about what a thesis should consist of: I worked on so many things during the four years of my 
doctorate that I found myself somewhat lost when I had to decide what to write in the thesis. There are 
official documents suggesting \emph{how} the thesis should be written, but not exactly \emph{what} should be 
written -- I find the definitions somewhat vague. For example, the manual of our university states that a 
\q{thesis consists of the result of a research which is presented as the final requirement for the completion 
of a doctorate}\footnote{\citeonline{UFRRJ2006}}, which is quite the same thing said by the International 
Organization for Standardization (\iso): a \q{document which presents the author's research and findings and 
submitted by him in support of his candidature for a degree or professional 
qualification}\footnote{\citeonline{ISO1986}}. I tried reading other theses to see if I could get an 
inspiration. I also discussed this matter with my patient supervisors Lúcia Anjos (Universidade Federal Rural 
do Rio de Janeiro, Brazil), Gustavo Vasques (Embrapa Solos, Brazil), and Gerard Heuvelink (ISRIC -- World Soil 
Information, the Netherlands). Unfortunately, for one reason or another, I was never satisfied with the 
outcome.

At first, I was a bit desperate. Have I failed? Has everyone failed? I hoped not! Perhaps the lack of an 
objective, ultimate, universal definition of what a thesis should consist of meant that, as a doctorate 
student, it was my responsibility to construct such a definition. This idea gave me back the long-lost 
excitement to write my thesis. I did not want to follow a boring ritual. I wanted to have fun and be completely 
honest with the reader, as Richard Webster\footnote{\citeonline{Webster2003}} had once suggested. 
As such, I started thinking about all steps given since the start of the doctorate, something like \q{Once upon 
a time in Seropédica...}.

As the title says, this thesis is about a research on the factors determining a soil map to be more or less 
accurate, what I call \emph{sources of uncertainty}. Many of these sources are known, others are still unknown, 
and some are disregarded due to our ignorance -- or by convenience. When I wrote my doctorate research project, 
it seemed appropriate to aim at evaluating what I understood as being the main sources of uncertainty in the 
process of building a model to produce soil maps, a process that I call \emph{soil spatial modelling}. The 
reason was simple: soil spatial modelling using modern techniques was a growing activity in Brazilian 
universities and research centres, and I felt that many \emph{soil spatial modellers} were inclined towards 
using the most expensive data sources as the only way of producing higher accuracy soil maps of the Brazilian 
territory. I was preoccupied about these ideas -- which appeared to be sort of an euphoria about new remote 
sensors -- because I believed that high quality soil maps could be produced if we simply started using the data 
at hand.

Defining the main sources of uncertainty in soil spatial modelling required an operational definition, which 
was given based on the observation that, in general, the main decisions made by soil spatial modellers concern 
the a) calibration observations, b) covariates, and c) model structure. The general objective of evaluating 
these three mains sources of uncertainty was then divided into five specific objectives:

\begin{enumerate}[label=(\Roman*)]
\item Identify appropriate calibration sample sizes and designs for soil spatial modelling;

\item Determine the accuracy of freely available covariates and their suitability to calibrate soil spatial 
models;

\item Identify appropriate covariate selection methods to build linear soil spatial models;

\item Assess the effect of multicollinearity among covariates on the performance of linear soil spatial models;

\item Identify database scenarios in which non-linear soil spatial models are more efficient than linear soil 
spatial models.
\end{enumerate}

The idea was to deal with each of the objectives separately and present the results in individual chapters of 
the thesis which would be submitted for publication in peer reviewed journals. The main expected result was the 
definition of a sound \emph{working protocol} that would allow the construction of efficient soil spatial 
models. My goal was to contribute to national (Brazilian Research Network on Digital Soil Mapping -- \redemds) 
and international (\gsm{} and Global Soil Information Facilities -- \gsif) initiatives, while generating a 
significant amount of bibliographic material to support the teaching of modern soil spatial modelling 
techniques in soil classes at Brazilian universities.

\def\footlatex{\footnote{See more about \LaTeX{} in \href{https://en.wikipedia.org/wiki/LaTeX}{Wikipedia}. The 
\LaTeX{} 
class that I have adapted to compile this thesis is available in 
\href{https://github.com/samuel-rosa/UFRuralRJ}{GitHub}.}}

With time it became clear that the five objectives and the expected results were too ambitious. I certainly was 
overwhelmed by the knowledge of the multiple sources of uncertainty, and felt compelled to develop a very 
thorough study. But I forgot that a doctorate includes more activities than those planned in the research 
project: you take classes, prepare grant proposals, write reports, help colleagues, get involved in other 
projects -- such as adapting the \LaTeX{}\footlatex{} class used to compile this thesis --, publish the papers 
of your master thesis, train undergraduate students, create and maintain the newsletter of a scientific group, 
read many articles and books, learn a couple of computer languages, start a relationship, get sick, and so on. 
Then, one day you realize that two years are already gone by and you still are preparing the database with 
which you will develop your case studies.

\def\footr{\footnote{See more about \texttt{R} in 
\href{https://en.wikipedia.org/wiki/R_\%28programming_language\%29}{Wikipedia}.}}

I know that I was particularly lucky for most of the soil and covariate data already being available for my 
use. This is because I have decided very early to continue using the data that I collected during my master so 
that I could go deeper into the details of modern soil spatial modelling techniques. Looking back, I think that 
this was the right decision. However, the resources needed to properly organize the data before I could 
actually use it were considerable. This effort was in line with my original intent of defining a working 
protocol for constructing soil spatial models, which I guess to have achieved, at least partially. Then I 
realized that I also needed to make my research the most reproducible as possible. The way to go was to make a 
thorough description of all data processing steps, including making available all computer scripts so that they 
could be reused by other people. The result was thousands of lines of computer code, mostly on 
\texttt{R}\footr{}, which I used to indirectly access most of other computer programs. These computer scripts 
have shown to be invaluable for my own applications, and I always hoped that other people will find them useful 
as well. But I then learned that many well known methods of data analysis/processing are not used simply 
because they are not implemented in a (single) software package. As such, making only the computer scripts 
available did seem to be a poor solution. Developing and maintaining a software package in the most popular 
environment for data processing and analysis, i.e. \texttt{R}\footr{}, was a natural decision. Although being 
fun, programming took a lot of resources!

A significant amount of resources was also spent preparing a description of the soil-forming factors and 
processes that determine the soil spatio-temporal distribution in the study area where the case studies were to 
be developed. Such a description is what I call \emph{conceptual model of pedogenesis}. This was another effort 
in line with the definition of a working protocol because I believe that soil spatial modelling is not only 
about making maps, but also constructing soil knowledge. Within the scope of the thesis, this knowledge was 
expected to serve the development of an experiment devoted to meeting the third objective of the research 
project. My intent was to compare automated covariate selection methods with the use of expert knowledge. 
Preliminary tests were conducted with a few experts to help planning the experiment, which was believed to be a 
complex one. Preliminary results were encouraging, but since I needed to give more attention to the first and 
second objectives, I had to temporarily stop working on the third objective.

There also was my poor knowledge on some known topics, which sometimes took me to the wrong direction. For 
example, I wanted to evaluate how much more accurate a soil map is when more accurate covariates are used 
(second objective), the reason being that I was concerned with the fact that the covariates too are in error. 
As such, I collected field data to validate the covariates and correct them for any systematic errors. Only 
later, discussing with Gerard, I understood that 1) the validation data was poor, and 2) in soil spatial 
modelling the covariates are generally taken as they are. The latter is like assuming that the covariates were 
measured without error -- otherwise a technique called error propagation analysis (or uncertainty analysis) can 
be employed to take that error into account. As such, the second objective of the research project needed to be 
reformulated in terms of how to define the different covariates that we had at hand. After many discussions we 
still were unable to reach a satisfactory solution, which did not prevent the study from being developed. Quite 
interesting results were produced, but presenting them also was a challenge: many models and covariates had 
been compared, and we wanted to have a summary way of presenting them, preferentially a figure. We came up with 
a figure that we later called a \emph{model series plot}, i.e. a figure that depicts a series of models ordered 
according to some chosen summary performance statistic. For the purpose of our study, that was a useful figure, 
and I hope that the readers have understood how to interpret it. The reviewers of our paper were fundamental 
for improving the description of the model series plot. Fortunately, they were also able to help deciding upon 
a proper definition for the differences observed between the covariates that were being compared. The study was 
not exactly about their accuracy, but about how they were produced and their level of spatial detail.

Devising an experiment to evaluate the influence of sample size and design on the accuracy of soil maps also 
was a challenge. Most soil data used for soil spatial modelling were produced in the past century (legacy data) 
with observation locations purposively selected by soil spatial modellers using tacit rules. As such, I wanted 
to build an algorithm composed of a set of objective decision rules that would produce spatial samples similar 
to those produced by a soil spatial modeller. I would then simulate budget scenarios for sampling and see how 
different spatial samples would perform regarding soil map accuracy. But how to devise such an algorithm? I 
interviewed the soil spatial modellers that produced the soil data to be used to conduct the case studies, 
carried out a point pattern analysis of the resulting spatial sample configuration, and explored psychological 
concepts to understand the whys of the locations of the sampling points. A lengthy study was carried out, which 
provided evidence that many poorly understood factors influence the decision of soil spatial modellers on where 
to make soil observations. From one perspective, this enables one to plan more efficient soil observation 
campaigns. However, it did not help finding a practical solution for the problem that we had at hand. Perhaps 
it was more appropriate to explore the existing, less complex algorithms that produce spatial samples using 
more objective decision rules formulated with basis on conceptual and operational factors.

\def\foottravel{\footnote{See about the \emph{travelling salesman problem} at 
\href{https://en.wikipedia.org/wiki/Travelling_salesman_problem}{Wikipedia}.}}

We then invited Dick Brus (Alterra, the Netherlands) to participate devising the experiment to evaluate the 
influence of sample size and design on the accuracy of soil maps. After some talks and a bibliographic review, 
we decided for using sampling algorithms that are based on the so-called spatial simulated annealing which are 
commonly used to produce spatial samples for soil spatial modelling. The problem was that we did not know of 
spatial simulated annealing being implemented in any free and open source software package in a way that could 
meet the requirements of our study. Again, the solution was to work on our own implementation of spatial 
simulated annealing, which resulted in a second package for R. Having decided the sampling algorithm to 
work with, we needed to choose a sound method to take sampling costs into account. Because the access time to 
sampling points usually is the major cost component in soil sampling, Gerard and I thought of coupling with 
spatial simulated annealing an algorithm to solve the problem of travelling from one sampling point to the next 
with the least cost\foottravel. This would be a good piece of work, but we soon realized that solving the 
travelling problem was impossible given the available resources. The goal of taking sampling costs into account 
ended up being dropped out.

After some time working on the sampling experiment, which at the time seemed simpler than ever, we came to 
learn that the sampling algorithms that we had chosen had weaknesses -- apparently like any algorithm. So, we 
thought that, perhaps, we could improve on those algorithms! A literature review suggested that we were correct 
and there was room for algorithmic improvements. Working on these improvements took a lot of resources, and I 
guess we came up with interesting, sound solutions. We only needed to know if the algorithmic improvements had 
any practical added value before evaluating the influence of sample size and design of prediction accuracy. It 
seemed appropriate to carry out two experiments, the first to evaluate the algorithmic improvements, the second 
to compare the algorithms. Again, the results were promising, specially from the algorithmic point of view. 
With regard to prediction accuracy, we cannot make high claims because the algorithms were tested using a 
single case study. But this gap should be easily filled since we have made our software package freely 
available for anyone to use. The negative side of these important developments is that carrying out the 
experiment to evaluate covariate selection methods became impossible due to the remaining resources available. 
This was a pity because I visited Murray Lark at the the British Geological Survey (\bgs) headquarters in 
Nottingham, UK, to discuss about that experiment.

Like it happened with the third objective, there was not enough time to conduct experiments to meet the 
fourth and fifth objectives. I think the topic of the fourth objective is a very important one, directly 
related to the problem of selecting covariates, which I really wanted to deal with. I would 
have been very happy if I could discuss the topic at least partially, but perhaps partial solutions may not be 
very useful. As for the fifth objective, I believe that developing a sound globally relevant work on the topic 
requires using several datasets, not a single dataset as I explored in my research project.

As a consequence of all these events, at the end of the doctorate, I was able to meet only the first and second 
\emph{scientific} objectives -- \emph{scientific} in the sense of answering research questions -- of my 
doctorate research project. This may seem little but only because the research project was too ambitious. Aside 
from meeting the original scientific objectives, I guess I made other important contributions that one may call 
\emph{technical} contributions -- \emph{technical} in the sense of practical application -- that were part of 
the original goal of defining a working protocol for soil spatial modelling. This includes, for example, 
documenting the soil and covariate data, as well as their processing steps, and describing the soil-forming 
factors that determine the soil spatio-temporal distribution in the study area. I know that these technical 
contributions do not help meeting any of the original scientific objectives. The same applies to the two 
\texttt{R}-packages that I developed and maintained, and the experiment conducted to understand how soil 
spatial modellers decide upon where to observe the soil, which were not originally planned in the research 
project. But I guess this is still valid, perhaps very important, as it seems to be common in any scientific 
research: you end up doing many things that are quite different from those that you were originally planning to 
do.

So... this is, more or less, the \emph{story} of the research that I have carried out in collaboration with my 
supervisors and co-authors during my doctorate. Perhaps one will find this story biased towards the negative 
aspects of my doctorate. This is not entirely false, specially because I think that I generally tend to be 
happier with stories that have more errors than hits -- because I learn more with the former than with the 
latter. As such, I guess there is nothing to write in this thesis other than what I have done during the 
doctorate that is directly and/or indirectly related to the original research project, have it been planned or 
not, be it a technical or scientific contribution, completed or not. This is what I present as the final 
requirement for the completion of the doctorate.

I do hope that my supervisors and co-authors like the work that I have done in the past four years. Lúcia, 
Gustavo, Gerard, and Dick have been so patient, so understanding, so respectful, that I have no words to 
prepare the deserved thanks. Each one of them with a different background, a different life story, a different 
perspective, working in a different part of the world... I learned a lot with them: soil science, mathematics, 
statistics, informatics, English, politics and science, human relations, and much more. What a pleasure 
experience working with the four of you!

I also hope that the outcome of my doctorate is of interest for the supporting institutions, 
because I would never write this thesis without their support. These are:

\begin{itemize}
 \item Universidade Federal Rural do Rio de Janeiro, through the Post-Graduate Course in Agronomy -- Soil 
 Science and Department of Soil Science, for providing a solid soil science education, unconditionally 
 supporting my research, and finding the means to guarantee my participation in several international events;
 
 \item Ministry of Science and Technology of Brazil, through the CNPq Foundation (Process 140720/2012-0), that
 provided a three-year grant without which I would not be able to develop any research at all;
 
 \item Ministry of Education of Brazil, through the CAPES Foundation (Process ID BEX 11677/13-9), that funded
 my one-year stay in the Netherlands, where most of the research was actually developed;
 
 \item ISRIC -- World Soil Information, for unconditionally supporting my research.
 
 \item Embrapa Soils, for supporting my research.
 
 \item Universidade Federal de Santa Maria, through the Department of Soil Science, for supporting my research.

 \item Ministry of the Environment of Brazil, for providing some of the data that we used.
\end{itemize}

I need to note that six individuals gave important contributions during the preparation of the 
data that were used to develop the case studies. Three of them are from the Universidade 
Federal Rural do Rio de Janeiro: Fabio Paes Leme Ferreira, Anastácia Perci Campos de Almeida, and Mauro Antônio 
Homem Antunes. The other three are from the Universidade Federal de Santa Maria: Ricardo Simão Diniz Dalmolin, 
Jean Michel Moura Bueno, and Luis Fernando Chimelo Ruiz. Along with them, I must thank the development teams 
and module/package authors of the many free and open source software and operating system that were used to 
develop the case studies.

Many other individuals have also given some form of scientific and/or technical contribution, be it through 
the exchange of email messages, chatting during a coffee break, a short visit to their home institutions, or 
any other informal occasion. Their contributions were invaluable for usually raising unforeseen questions, 
pointing to extremely helpful references, and helping me seeing the research problems from another perspective.
Special thanks are due to Ad van Oostrum, Andreas Papritz, Bas Kempen, Bradley Miller, Chantal Hendriks, 
Dominique Arrouays, Edgardo Ramos Medeiros, Eloi Carvalho Ribeiro, Jorge Mendes de Jesus, Madlene Nussbaum, 
Marcos Angelini, Murray Lark, Nicolas Saby, Pablo Miguel, Pedro de Souza Calegaro, Richard Webster, Thomas 
Caspari, Tom Hengl, Titia Mulder, and many others that I might have forgotten.

Having the story of a doctorate to tell depends not only on scientific and/or technical contributions,
but also on the unconditional support of family, friends, and colleagues. My family, which gained several new 
members in the last four years, was strong enough to understand my rare and short visits, and the importance 
of a long stay on the other side of the Atlantic. Although my mother (Elaine), father (Adir), and brother 
(Eduardo) have only a vague idea of what I have been working on, their support was incommensurable. 
South-American and European friends were invaluable: Marcos, Indira, Eloi, Thomas, Nina, Jorge, André, Thiago, 
and Andriéli. There was the amazing, coolest of them all, ISRIC family, which I miss very much, lead by 
our dearest Yolanda. There also were my postgraduate colleagues and teachers. But one friend deserves a special 
thanks: Manoeli! Thank you Manoeli -- by destiny or a strange coincidence --, born and raised in the same small 
town, after completing the bachelor and master together in Brazil, we ended up sharing the same house in The 
Netherlands during the doctorate. There, we continued our philosophical chats about all aspects of life, the 
universe, and everything which we started years ago. It was a pleasure to share a full year with such a 
wonderful friend!

Finally, three little Bacchanalian creatures, one having only a vague idea of my work, the other two not 
speaking any human language, deserve my most sincere thanks: Monique, Tupã, and Dindi! Your love was fire 
through my veins!

\begin{flushright}
 Alessandro Samuel Rosa
 
 Seropédica, February 2016.
\end{flushright}
